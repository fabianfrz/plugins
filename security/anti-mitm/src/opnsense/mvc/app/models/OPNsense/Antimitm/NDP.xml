<model>
  <mount>//OPNsense/anti_mitm/NDPMon</mount>
  <description>NDP Monitor configuration</description>
  <items>
    <!-- General settings -->
    <enabled type="BooleanField">
      <default>0</default>
      <Required>Y</Required>
    </enabled>
    <high_priority_sendmail type="BooleanField">
      <default>0</default>
      <Required>Y</Required>
    </high_priority_sendmail>
    <high_priority_syslog type="BooleanField">
      <default>1</default>
      <Required>Y</Required>
    </high_priority_syslog>
    <low_priority_sendmail type="BooleanField">
      <default>0</default>
      <Required>Y</Required>
    </low_priority_sendmail>
    <low_priority_syslog type="BooleanField">
      <default>1</default>
      <Required>Y</Required>
    </low_priority_syslog>
    <admin_mail type="TextField">
      <Required>Y</Required>
      <default>root@localhost</default>
      <mask>/^.*@.*$/</mask>
    </admin_mail>
    <reverse_hostlookups type="BooleanField">
      <default>0</default>
      <Required>Y</Required>
    </reverse_hostlookups>
    
    <!-- Router -->
    <router type="ArrayField">
      <enabled type="BooleanField">
        <default>1</default>
        <Required>Y</Required>
      </enabled>
      <name type="TextField">
        <Required>N</Required>
      </name>
      <lla type="NetworkField">
        <default>2001:db8:1234:5678::</default>
        <Required>Y</Required>
      </lla>
      <mac type="TextField">
        <default>11:22:33:44:55:66</default>
        <Required>Y</Required>
        <mask>/^[0-9a-f]{2,2}:[0-9a-f]{2,2}:[0-9a-f]{2,2}:[0-9a-f]{2,2}:[0-9a-f]{2,2}:[0-9a-f]{2,2}$/i</mask>
      </mac>
      <curhoplimit type="IntegerField">
        <default>64</default>
        <MinimumValue>1</MinimumValue>
        <Required>N</Required>
        <MaximumValue>255</MaximumValue>
      </curhoplimit>
      <flags_reserved type="IntegerField">
        <default>64</default>
        <MinimumValue>0</MinimumValue>
        <Required>N</Required>
        <MaximumValue>255</MaximumValue>
      </flags_reserved>
      <lifetime type="IntegerField">
        <Required>N</Required>
      </lifetime>
      <reachable_timer type="IntegerField">
        <Required>N</Required>
      </reachable_timer>
      <mtu type="IntegerField">
        <Required>N</Required>
      </mtu>
      <volatile type="IntegerField">
        <Required>N</Required>
      </volatile>
    </router>

    <!-- Prefixes -->
    <prefix type="ArrayField">
      <enabled type="BooleanField">
        <default>1</default>
        <Required>Y</Required>
      </enabled>
      <address type="NetworkField">
        <default>2001:db8:1234:5678::</default>
        <Required>Y</Required>
      </address>
      <mask type="IntegerField">
        <default>64</default>
        <Required>Y</Required>
      </mask>
      <flags_reserved type="IntegerField">
        <default>224</default>
        <Required>N</Required>
      </flags_reserved>
      <valid_time type="IntegerField">
        <default>2592000</default>
        <Required>N</Required>
      </valid_time>
      <preferred_time type="IntegerField">
        <default>604800</default>
        <Required>N</Required>
      </preferred_time>
    </prefix>
  </items>
</model>
